(()=>{"use strict";var t={179:(t,e,n)=>{n.d(e,{jR:()=>s});var i=function(t){return function(t){return"string"==typeof t||t instanceof String}(t)?t.trim():""},s=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return t.replace(/\.+/g,".|").replace(/\?/g,"?|").replace(/\!/g,"!|").split("|").map((function(t){return i(t)})).filter(Boolean)}}},e={};function n(i){var s=e[i];if(void 0!==s)return s.exports;var o=e[i]={exports:{}};return t[i](o,o.exports,n),o.exports}n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t=/^(?:(en-GB-oed|i-ami|i-bnn|i-default|i-enochian|i-hak|i-klingon|i-lux|i-mingo|i-navajo|i-pwn|i-tao|i-tay|i-tsu|sgn-BE-FR|sgn-BE-NL|sgn-CH-DE)|(art-lojban|cel-gaulish|no-bok|no-nyn|zh-guoyu|zh-hakka|zh-min|zh-min-nan|zh-xiang))$|^((?:[a-z]{2,3}(?:(?:-[a-z]{3}){1,3})?)|[a-z]{4}|[a-z]{5,8})(?:-([a-z]{4}))?(?:-([a-z]{2}|\d{3}))?((?:-(?:[\da-z]{5,8}|\d[\da-z]{3}))*)?((?:-[\da-wy-z](?:-[\da-z]{2,8})+)*)?(-x(?:-[\da-z]{1,8})+)?$|^(x(?:-[\da-z]{1,8})+)$/i,e=function(t){return"string"==typeof t||t instanceof String},i=function(t){return e(t)?t.trim():""};const s={trim:i,isNan:function(t){return"number"==typeof t&&isNaN(t)},isNil:function(t){return null==t},isObject:function(t){return"[object Object]"===Object.prototype.toString.call(t)},size:function(t){return t&&Array.isArray(t)&&t.length?t.length:0},isString:e,splitSentences:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return t.replace(/\.+/g,".|").replace(/\?/g,"?|").replace(/\!/g,"!|").split("|").map((function(t){return i(t)})).filter(Boolean)},validateLocale:function(e){return"string"==typeof e&&t.test(e)}};var o={};function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.browserSupport="speechSynthesis"in window&&"SpeechSynthesisUtterance"in window,this.synthesisVoice=null}var e,n,i;return e=t,n=[{key:"init",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise((function(n,i){t.browserSupport||i("Your browser does not support Speech Synthesis");var o=(0,s.isNil)(e.listeners)?{}:e.listeners,a=!!(0,s.isNil)(e.splitSentences)||e.splitSentences,r=(0,s.isNil)(e.lang)?void 0:e.lang,u=(0,s.isNil)(e.volume)?1:e.volume,l=(0,s.isNil)(e.rate)?1:e.rate,c=(0,s.isNil)(e.pitch)?1:e.pitch,h=(0,s.isNil)(e.voice)?void 0:e.voice;Object.keys(o).forEach((function(t){var e=o[t];"onvoiceschanged"!==t&&(speechSynthesis[t]=function(t){e&&e(t)})})),t._loadVoices().then((function(e){o.onvoiceschanged&&o.onvoiceschanged(e),!(0,s.isNil)(r)&&t.setLanguage(r),!(0,s.isNil)(h)&&t.setVoice(h),!(0,s.isNil)(u)&&t.setVolume(u),!(0,s.isNil)(l)&&t.setRate(l),!(0,s.isNil)(c)&&t.setPitch(c),!(0,s.isNil)(a)&&t.setSplitSentences(a),n({voices:e,lang:t.lang,voice:t.voice,volume:t.volume,rate:t.rate,pitch:t.pitch,splitSentences:t.splitSentences,browserSupport:t.browserSupport})})).catch((function(t){i(t)}))}))}},{key:"_fetchVoices",value:function(){return new Promise((function(t,e){setTimeout((function(){var n=speechSynthesis.getVoices();return(0,s.size)(n)>0?t(n):e("Could not fetch voices")}),100)}))}},{key:"_loadVoices",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this._fetchVoices().catch((function(n){if(0===e)throw n;return t._loadVoices(e-1)}))}},{key:"hasBrowserSupport",value:function(){return this.browserSupport}},{key:"setVoice",value:function(t){var e,n=speechSynthesis.getVoices();if((0,s.isString)(t)&&(e=n.find((function(e){return e.name===t}))),(0,s.isObject)(t)&&(e=t),!e)throw"Error setting voice. The voice you passed is not valid or the voices have not been loaded yet.";this.synthesisVoice=e}},{key:"setLanguage",value:function(t){if(t=t.replace("_","-"),!(0,s.validateLocale)(t))throw"Error setting language. Please verify your locale is BCP47 format (http://schneegans.de/lv/?tags=es-FR&format=text)";this.lang=t}},{key:"setVolume",value:function(t){if(t=parseFloat(t),!(!(0,s.isNan)(t)&&t>=0&&t<=1))throw"Error setting volume. Please verify your volume value is a number between 0 and 1.";this.volume=t}},{key:"setRate",value:function(t){if(t=parseFloat(t),!(!(0,s.isNan)(t)&&t>=0&&t<=10))throw"Error setting rate. Please verify your volume value is a number between 0 and 10.";this.rate=t}},{key:"setPitch",value:function(t){if(t=parseFloat(t),!(!(0,s.isNan)(t)&&t>=0&&t<=2))throw"Error setting pitch. Please verify your pitch value is a number between 0 and 2.";this.pitch=t}},{key:"setSplitSentences",value:function(t){this.splitSentences=t}},{key:"speak",value:function(t){var e=this;return new Promise((function(n,i){var o=t.text,a=t.listeners,r=void 0===a?{}:a,u=t.queue,l=void 0===u||u,c=(0,s.trim)(o);(0,s.isNil)(c)&&n(),!l&&e.cancel();var h=[],p=e.splitSentences?(0,s.splitSentences)(c):[c];p.forEach((function(t,o){var a=o===(0,s.size)(p)-1,u=new SpeechSynthesisUtterance;e.synthesisVoice&&(u.voice=e.synthesisVoice),e.lang&&(u.lang=e.lang),e.volume&&(u.volume=e.volume),e.rate&&(u.rate=e.rate),e.pitch&&(u.pitch=e.pitch),u.text=t,Object.keys(r).forEach((function(t){var e=r[t];u[t]=function(s){e&&e(s),"onerror"===t&&i({utterances:h,lastUtterance:u,error:s}),"onend"===t&&a&&n({utterances:h,lastUtterance:u})}})),h.push(u),speechSynthesis.speak(u)}))}))}},{key:"pending",value:function(){return speechSynthesis.pending}},{key:"paused",value:function(){return speechSynthesis.paused}},{key:"speaking",value:function(){return speechSynthesis.speaking}},{key:"pause",value:function(){speechSynthesis.pause()}},{key:"resume",value:function(){speechSynthesis.resume()}},{key:"cancel",value:function(){speechSynthesis.cancel()}}],n&&a(e.prototype,n),i&&a(e,i),t}();const u=r;function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function c(t,e){p(t,e),e.add(t)}function h(t,e,n){p(t,e),e.set(t,n)}function p(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function d(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,g(t,e,"get"))}function f(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function v(t,e,n){return function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(t,g(t,e,"set"),n),n}function g(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}var y=new WeakMap,w=new WeakMap,m=new WeakMap,S=new WeakMap,b=new WeakMap,T=new WeakMap,k=new WeakMap,_=new WeakMap,x=new WeakSet,B=new WeakSet,A=new WeakSet,E=new WeakSet,j=function(){function t(e,n,i,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),c(this,E),c(this,A),c(this,B),c(this,x),h(this,y,{writable:!0,value:""}),h(this,w,{writable:!0,value:{}}),h(this,m,{writable:!0,value:[]}),h(this,S,{writable:!0,value:""}),h(this,b,{writable:!0,value:""}),h(this,T,{writable:!0,value:""}),h(this,k,{writable:!0,value:""}),h(this,_,{writable:!0,value:[]}),v(this,w,e),v(this,m,n),v(this,T,i),v(this,k,s),f(this,x,C).call(this),f(this,B,O).call(this,s,i)}var e,n,i;return e=t,n=[{key:"isAndroid",value:function(){var t=navigator.userAgent.toLowerCase().indexOf("android")>-1;return!!t}},{key:"getBrowser",value:function(){return d(this,y)}},{key:"getLanguage",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d(this,S),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d(this,b);return d(this,b)===e||f(this,B,O).call(this,t,e),d(this,b)}},{key:"getVoice",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d(this,S),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d(this,b);return d(this,S)===t||f(this,B,O).call(this,t,e),d(this,S)}}],n&&l(e.prototype,n),i&&l(e,i),Object.defineProperty(e,"prototype",{writable:!1}),t}();function C(){var t=this,e=d(this,w).browser;Object.keys(e).map((function(n){e[n]&&v(t,y,n.replace("is_",""))}))}function O(t,e){var n,i="",s=t||d(this,k),o=e||d(this,T),a=f(this,A,L).call(this,o),r=f(this,E,P).call(this,a);if(r.length>1)for(var u=0;u<r.length;u++){if(i=r[u].lang,n=r[u].name,s===r[u].name){v(this,S,n),v(this,b,i);break}v(this,S,n),v(this,b,i)}else v(this,S,r[0].name),v(this,b,r[0].lang)}function L(t){return null!=t.indexOf("-")?t.split("-")[0]:null!=t.indexOf("_")?t.split("_")[0]:t}function P(t){var e=this;return v(this,_,[]),Object.values(d(this,m)).map((function(n){var i=new RegExp(t,"gi");null!==n.lang.match(i)&&n.name&&d(e,_).push(n)})),d(this,_)}var z=n(179);function N(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function R(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function V(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var M,I=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:window.TTS;N(this,t),V(this,"TTS",window.TTS),V(this,"browser",null),V(this,"speech",null),V(this,"speechSynthesis",window.speechSynthesis),V(this,"utterence",new SpeechSynthesisUtterance),V(this,"speechRecognitionIsActive",!0),V(this,"speechRecognition",window.speechRecognition||window.webkitSpeechRecognition),V(this,"recordStatus","record"),V(this,"listenStatus","listen"),V(this,"noticeClass","tta_notice"),V(this,"cofiguration",{}),V(this,"timer",null),V(this,"buttonId",null),V(this,"speakButton",null),V(this,"content",null),V(this,"ttsListeningSettings",null),V(this,"languages",[]),V(this,"voices",{}),V(this,"voice","English United Kingdom"),V(this,"language","en_GB"),V(this,"buttonTextArr",null),V(this,"splittedSentances",""),V(this,"isCanceled",!1),V(this,"shouldCancelTimer",null),V(this,"callBackAfterEnd",null),V(this,"splitSentences",null),this.TTS=s,this.content=n||window.TTS.contents[e],this.splittedSentances=(0,z.jR)(n),this.buttonId=e,this.buttonTextArr=this.TTS.settings.textArr,this.speakButton=i||document.getElementById(e),this.ttsListeningSettings=this.TTS.settings.listening,this.speech=new u,this.splitSentences=z.jR}var e,n,i;return e=t,n=[{key:"getData",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return t&&(window.TextToSpeech=this),this}},{key:"playButtonText",value:function(){return this.buttonTextArr.listen_text}},{key:"playButtonContent",value:function(){return'<div class="tts_button"><span class="dashicons dashicons-controls-play"></span> <span> '+this.playButtonText()+"<span></span></span></div>"}},{key:"replayButtonText",value:function(){return this.buttonTextArr.replay_text}},{key:"replayButtonContent",value:function(){return'<div class="tts_button"><span class="dashicons dashicons-image-rotate"></span> <span> '+this.replayButtonText()+"<span></span></span></div>"}},{key:"pauseButtonText",value:function(){return this.buttonTextArr.pause_text}},{key:"pauseButtonContent",value:function(){return'<div class="tts_button"><span class="dashicons dashicons-controls-pause"></span> <span> '+this.pauseButtonText()+"<span></span></span></div>"}},{key:"resumeButtonText",value:function(){return this.buttonTextArr.resume_text}},{key:"resumeButtonContent",value:function(){return'<div class="tts_button"><span class="dashicons dashicons-controls-play"></span> <span> '+this.buttonTextArr.resume_text+"<span></span></span></div>"}},{key:"recordStartButtonContent",value:function(){return'<span class="dashicons dashicons-controls-volumeoff"></span> '+this.buttonTextArr.start_text}},{key:"recordStopButtonConten",value:function(){return'<span class="dashicons dashicons-controls-volumeon"></span> '+this.buttonTextArr.stop_text}},{key:"displayApiMissing",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="",i="";if(this.speechRecognitionIsActive||(n+="Text To Audio: Please enable speechRecognition"),this.speechSynthesis||(n+=n?" , speechSynthesis.":"Text To Audio: Please enable speechSynthesis."),t){var s=document.getElementById(t).previousSibling;s?(n+=' Click here to <a href="https://wordpress.org/plugins/text-to-audio/#how%20to%20enable%20%60%60speechsynthesis%60%60%20on%20firefox%3F" target="_blank">enable</a>',s.style.display="block",s.innerHTML=n,setTimeout((function(){document.querySelector(".tta_notice").style.display="none",s.innerHTML=""}),5e3)):(i+=ttsObj.admin_url+"admin.php?page=text-to-audio#/docs",n+="\nFollow this link to enable: \n".concat(i),alert(n))}else e||"?page=text-to-audio"===location.search&&"#/customize"===location.hash?i+=ttsObj.admin_url+"admin.php?page=text-to-audio#/docs":i+="https://wordpress.org/plugins/text-to-audio/#how%20to%20enable%20%60%60speechsynthesis%60%60%20on%20firefox%3F",n+="\nFollow this link to enable: \n".concat(i),alert(n);throw new Error(n)}},{key:"displayButtonText",value:function(t){ttsObj.is_pro_license_active||("listen"===t?(this.speakButton.innerHTML=this.replayButtonContent(),this.speakButton.setAttribute("title","Text To Audio : "+this.replayButtonText())):"pause"===t?(this.speakButton.innerHTML=this.pauseButtonContent(),this.speakButton.setAttribute("title","Text To Audio : "+this.pauseButtonText())):"resume"===t&&(this.speakButton.innerHTML=this.resumeButtonContent(),this.speakButton.setAttribute("title","Text To Audio : "+this.resumeButtonText())))}},{key:"speak",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.content;this.speech.hasBrowserSupport()?(t.setLanguage(this.browser.getLanguage()),t.setVoice(this.browser.getVoice()),t.speak({text:n,queue:!1,listeners:{onstart:function(t){console.log("Start utterance"),e.utterence=t,wp.hooks.doAction("tts_high_light_text",t.currentTarget.text,e.buttonId,z.jR)},onend:function(t){console.log("End utterance")},onpause:function(t){console.log("Pause utterance")},onresume:function(t){console.log("Resume utterance")},onboundary:function(t){}}}).then((function(n){e.speech.speaking()||(console.log("End utterance "+e.speech.speaking()),e.listenStatus="listen",e.displayButtonText(e.listenStatus),e.content=window.ttsContent,e.splittedSentances=(0,z.jR)(window.ttsContent),t.cancel()),console.log("Success !",n),e.callBackAfterEnd&&e.callBackAfterEnd(),e.browser.isAndroid()||(clearTimeout(e.timer),e.timer=null,clearTimeout(e.shouldCancelTimer),e.shouldCancelTimer=null),window.sessionStorage.setItem("tts_paused_by_intention",!1)})).catch((function(t){console.error("An error occurred :",t)})),this.listenStatus="pause",this.displayButtonText(this.listenStatus),this.browser.isAndroid()||(this.timer=setTimeout((function e(){t.pause(),console.log(t),setTimeout((function(){t.resume()}),0),this.timer=setTimeout(e,1e4),t.speaking()||(clearTimeout(this.timer),this.timer=null)}),1e4))):this.displayApiMissing("tts__listent_content_"+this.buttonId)}},{key:"pause",value:function(t){var e=this;this.browser.isAndroid()?(t.cancel(),this.isCanceled=!0):(t.pause(),this.shouldCancelTimer=setInterval((function(){t.cancel(),e.isCanceled=!0}),7e3));var n=this.splittedSentances.indexOf(this.utterence.target.text);this.splittedSentances=this.splittedSentances.slice(n),this.content=this.splittedSentances.join(" "),this.listenStatus="resume",this.displayButtonText(this.listenStatus),this.browser.isAndroid()||clearTimeout(this.timer)}},{key:"resume",value:function(t){this.isCanceled?(this.speak(t,this.content),clearTimeout(this.shouldCancelTimer),this.browser.isAndroid()||clearTimeout(this.timer)):(t.resume(),clearTimeout(this.shouldCancelTimer)),this.listenStatus="pause",this.displayButtonText(this.listenStatus),this.browser.isAndroid()||(this.timer=setTimeout((function e(){t.pause(),console.log(t),setTimeout((function(){t.resume()}),0),this.timer=setTimeout(e,1e4),t.speaking()||(clearTimeout(this.timer),this.timer=null)}),1e4))}},{key:"_init",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.callBackAfterEnd=e,void 0!==this.ttsListeningSettings&&this.speech.init({volume:this.ttsListeningSettings.tta__listening_volume?this.ttsListeningSettings.tta__listening_volume:1,rate:this.ttsListeningSettings.tta__listening_rate?this.ttsListeningSettings.tta__listening_rate:1,pitch:this.ttsListeningSettings.tta__listening_pitch?this.ttsListeningSettings.tta__listening_pitch:2,splitSentences:!0,listeners:{onvoiceschanged:function(t){}}}).then((function(e){t.voices=e.voices,t.browser=new j(ttsObj,e.voices,t.ttsListeningSettings.tta__listening_lang,t.ttsListeningSettings.tta__listening_voice),t._prepareSpeakButton(t.speech),window.sessionStorage.setItem("tts_paused_by_intention",!1)})).catch((function(t){console.error("An error occured while initializing : ",t)}))}},{key:"_prepareSpeakButton",value:function(t){var e=this;"listen"==this.listenStatus?this.speak(t):"pause"==this.listenStatus?this.pause(t):"resume"==this.listenStatus&&this.resume(t),document.addEventListener("visibilitychange",(function(){"hidden"===document.visibilityState&&"pause"===e.listenStatus&&(e.pause(t),e.callBackAfterEnd&&e.callBackAfterEnd()),"visible"===document.visibilityState&&"resume"===e.listenStatus&&(JSON.parse(window.sessionStorage.getItem("tts_paused_by_intention"))?window.sessionStorage.setItem("tts_paused_by_intention",!1):e.resume(t),e.callBackAfterEnd&&e.callBackAfterEnd())}))}}],n&&R(e.prototype,n),i&&R(e,i),Object.defineProperty(e,"prototype",{writable:!1}),t}();window.TextToSpeech=I,M=setTimeout((function(){window.hasOwnProperty("ttsObj")&&ttsObj.is_dashboard&&(!function(){var t={listening:{tta__listening_lang:"en-US",tta__listening_voice:"Microsoft David - English (United States)",tta__listening_pitch:"1",tta__listening_rate:"1",tta__listening_volume:"1"},cssClass:"",btnStyle:"background-color:#ee6d6d;color:#ffffff;width:100%;border:0;display:block;border-radius:4px;text-decoration:none;cursor:pointer;",textArr:{listen_text:"Listen",pause_text:"Pause",resume_text:"Resume",replay_text:"Replay",start_text:"Start",stop_text:"Start"},customCSS:"",shouldDisplayIcon:"inline-block"},e=1,n="";if(window.hasOwnProperty("TTS")){window.TTS.contents[e-1]!==n&&(window.TTS.contents[e]=n)}else window.TTS={},window.TTS.contents={},window.TTS.contents[e]=n;window.TTS.hasOwnProperty("settings")||(window.TTS.settings=t,window.TTS.settings.readingTime=1)}(),clearTimeout(M),M=null)}),1e3)})()})();